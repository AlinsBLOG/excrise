<wxs src="../template/common.wxs" module="text" />
<import src='../template/template.wxml' />

<view class="container">
  <view class="cate-nav">
    <scroll-view 
      scroll-x="true" 
      class="cate-nav-body" 
      style="width: 750rpx;" 
      scroll-left="{{scrollLeft}}">
        <view  
          wx:for="{{navList}}"
          wx:key="{{index}}"
          class="item {{ condCode == item.id ? 'active' : ''}}" 
          data-id="{{item.id}}" 
          data-index="{{index}}" 
          bindtap="switchCate"
        >
            <view class="name">{{item.name}}</view>
        </view>
    </scroll-view>
  </view>

  <scroll-view 
    scroll-y="true" 
    scroll-top="{{scrollTop}}" 
    bindscrolltolower="bindDownLoad" 
    style="height:1128rpx;"
    class='list'>
    <view 
      wx:for='{{orderList}}'
      wx:key='{{index}}'
      bindtap='queryOrderDetail'
      data-order-id='{{item.orderId}}'
      >
      <view 
        class='serviceInfo'
        >
        <view class='serviceTitle'>
          <!-- <text class='service'>服务商</text> -->
          <text class='name'>订单编号：{{item.orderNo}}</text>
          <!-- <text class='level'>Lv7</text> -->
          <text class='state'>{{
          (item.state==9?'已取消':(item.state==10?'已支付':(item.state==11?'已完成':(item.state==1?'待支付':(item.state==0?'草稿':'')))))
          }}</text>
        </view>
      </view>
      <view>
        <view 
          class='serviceCenter'
          wx:for='{{item.items}}'
          wx:key='{{subIndex}}'
          wx:for-item='subItem'
          wx:for-index='subIndex'
        >
          <view class='left'>
            <text class='service'>服务商</text>
            <text class='name'>{{subItem.providerFullName}}</text>
            <text class='title'>{{subItem.prodName}}</text>
            <view>
              <text class='area'>服务地区：{{subItem.countyName}}</text>
              <text class='date'>服务期限：{{subItem.durationName}}</text>
            </view>
          </view>
          <text class='right'>
            ￥ {{text.formatPrice(subItem.orderPrice)}}
            <text class='amount'>x{{subItem.quantity}}</text>
          </text>
        </view>
        <view class='serviceBottom'>
          <view class='actPay'>实付:￥{{text.formatPrice(item.totalPaymentAmount)}}</view> 
          <view 
            class='orderState'
            wx:if='{{item.state==1}}'
            >
            <text 
              class='cancel' 
              data-orderId='{{item.orderId}}' 
              catchtap='cancelOrder'
            >取消订单</text>
            <text class='payNow'>立即支付</text>
          </view>
        </view>
      </view>
    </view>
    <view  wx:if='{{!orderList.length}}' class='serviceInfo' style='text-align:center'>
      暂无订单
    </view>
  </scroll-view>
</view>